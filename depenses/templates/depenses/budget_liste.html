{% extends 'base.html' %}
{% block title %}Budgets{% endblock %}
{% block content %}
<div class="flex justify-between items-center mb-6">
  <h1 class="text-2xl font-semibold">Mes Budgets</h1>
  <a href="{% url 'budget_add' %}" class="px-4 py-2 rounded border border-black text-black hover:bg-black hover:text-white">＋ Nouveau budget</a>
</div>

<div class="overflow-x-auto bg-white rounded-2xl shadow">
  <table class="min-w-full text-sm">
    <thead class="bg-gray-50">
      <tr class="text-left text-gray-600">
        <th class="px-4 py-3">Libellé</th>
        <th class="px-4 py-3">Période</th>
        <th class="px-4 py-3">Budget</th>
        <th class="px-4 py-3">Dépensé</th>
        <th class="px-4 py-3">Restant</th>
        <th class="px-4 py-3">Statut</th>
        <th class="px-4 py-3 text-right">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-100">
      {% for b in budgets %}
      <tr class="hover:bg-gray-50">
        <td class="px-4 py-3 font-medium">{{ b.libelle }}</td>
        <td class="px-4 py-3">{{ b.date_debut }} → {{ b.date_fin }}</td>
        <td class="px-4 py-3">{{ b.montant_budget }}</td>
        <td class="px-4 py-3">{{ b.total_depense }}</td>
        <td class="px-4 py-3">{{ b.restant }}</td>
        <td class="px-4 py-3">
          {% if b.statut == 'DEPASSE' %}
            <span class="px-2 py-0.5 rounded bg-rose-100 text-rose-700 text-xs">DÉPASSÉ</span>
          {% elif b.statut == 'COMPLET' %}
            <span class="px-2 py-0.5 rounded bg-amber-100 text-amber-700 text-xs">COMPLET</span>
          {% else %}
            <span class="px-2 py-0.5 rounded bg-green-100 text-green-700 text-xs">OK</span>
          {% endif %}
        </td>
        <td class="px-4 py-3">
          <div class="flex justify-end gap-2">
            <a href="{% url 'budget_edit' b.pk %}" class="px-3 py-1.5 rounded bg-green-600 text-white hover:bg-green-700">Modifier</a>
            <a href="{% url 'budget_delete' b.pk %}" class="px-3 py-1.5 rounded bg-rose-500 text-white hover:bg-rose-600">Supprimer</a>
          </div>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="7" class="px-4 py-6 text-center text-gray-500">Aucun budget.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
